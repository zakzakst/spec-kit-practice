---
description: "GitHub Copilot 用の高品質なカスタム指示ファイルを作成するためのガイドライン"
applyTo: "**/*.instructions.md"
---

# カスタム指示ファイルのガイドライン

GitHub Copilot がドメイン固有のコードを生成し、プロジェクトの規則に従うようにガイドする、効果的で保守可能なカスタム指示ファイルを作成する手順。

## プロジェクトの背景

- 対象読者: ドメイン固有のコードを扱う開発者とGitHub Copilot
- ファイル形式: YAML フロントマターを使用した Markdown
- ファイルの命名規則: ハイフン付きの小文字（例：`react-best-practices.instructions.md`）
- 場所: `.github/instructions/` 配下
- 目的: コード生成、レビュー、ドキュメント化のためのコンテキスト認識ガイダンスを提供する

## 必須の前文

すべての指示ファイルには、次のフィールドを含むYAMLフロントマターを含める必要があります。:

```yaml
---
description: "指導の目的と範囲の簡単な説明"
applyTo: "対象ファイルの glob パターン (例: **/*.ts、**/*.py)"
---
```

### 前書きガイドライン

- **description**: 目的を明確に示す、1～500文字の単一引用符で囲まれた文字列
- **applyTo**: これらの命令が適用されるファイルを指定する glob パターン
  - 単一パターン: `'**/*.ts'`
  - 複数パターン: `'**/*.ts, **/*.tsx, **/*.js'`
  - 特定のファイル: `'src/**/*.py'`
  - すべてのファイル: `'**'`

## ファイル構造

適切に構成された指示ファイルには、以下のセクションが含まれている必要があります:

### 1. タイトルと概要

- `#` 見出しを使用した明確で説明的なタイトル
- 目的と範囲を説明する簡単な紹介
- オプション: 主要なテクノロジーとバージョンを含むプロジェクトコンテキストセクション

### 2. コアセクション

ドメインに基づいてコンテンツを論理的なセクションに整理する:

- **一般的な指示**: 高レベルのガイドラインと原則
- **ベストプラクティス**: 推奨されるパターンとアプローチ
- **コード標準**: 命名規則、フォーマット、スタイルルール
- **建築/構造**: プロジェクトの構成と設計パターン
- **一般的なパターン**: よく使用される実装
- **セキュリティ**: セキュリティに関する考慮事項（該当する場合）
- **パフォーマンス**: 最適化ガイドライン（該当する場合）
- **テスト**: テスト基準とアプローチ（該当する場合）

### 3. 例とコードスニペット

明確なラベルを付けて具体的な例を挙げる:

```markdown
### 良い例

\`\`\`language
// 推奨されるアプローチ
コード例はこちら
\`\`\`

### 悪い例

\`\`\`language
// このパターンを避ける
コード例はこちら
\`\`\`
```

### 4. 検証と確認（オプションだが推奨）

- コードを検証するためのビルドコマンド
- リンティングとフォーマットツール
- テスト要件
- 検証手順

## コンテンツガイドライン

### 文体

- 明確で簡潔な言葉を使う
- 命令形で書く（「使用する」「実装する」「避ける」）
- 具体的かつ実行可能な内容にする
- 「～すべき」「～かもしれない」「～かもしれない」といった曖昧な表現は避けましょう
- 読みやすさのために箇条書きやリストを使用する
- セクションを焦点を絞って読みやすいものにする

### ベストプラクティス

- **具体的に**: 抽象的な概念ではなく具体的​​な例を挙げる
- **理由を示す**: 価値を追加する場合の推奨理由を説明する
- **表を使用する**: オプションの比較、ルールの一覧表示、パターンの表示
- **例を含める**: 実際のコードスニペットは説明よりも効果的です
- **最新情報を入手**: 現在のバージョンとベストプラクティスを参照する
- **リンクリソース**: 公式文書と信頼できる情報源を含める

### 含める一般的なパターン

1. **命名規則**: 変数、関数、クラス、ファイルの命名方法
2. **コードの構成**: ファイル構造、モジュール構成、インポート順序
3. **エラー処理**: 推奨されるエラー処理パターン
4. **依存関係**: 依存関係を管理および文書化する方法
5. **コメントとドキュメント**: コードをいつ、どのように文書化するか
6. **バージョン情報**: 対象言語/フレームワークのバージョン

## 従うべきパターン

### 箇条書きとリスト

```markdown
## セキュリティのベストプラクティス

- 処理前に常にユーザー入力を検証する
- パラメータ化されたクエリを使用してSQLインジェクションを防ぐ
- 秘密はコードではなく環境変数に保存する
- 適切な認証と承認を実装する
- すべての本番エンドポイントでHTTPSを有効にする
```

### 構造化情報のための表

```markdown
## よくある問題

| 問題                 | 解決方法               | 例                                       |
| -------------------- | ---------------------- | ---------------------------------------- |
| マジックナンバー     | 名前付き定数を使用する | `const MAX_RETRIES = 3`                  |
| 深いネスト           | 関数の抽出             | ネストされた if 文をリファクタリングする |
| ハードコードされた値 | 設定を使用する         | API URLをconfigに保存する                |
```

### コード比較

```markdown
### 良い例 - TypeScriptインターフェースの使用

\`\`\`typescript
interface User {
id: string;
name: string;
email: string;
}

function getUser(id: string): User {
// Implementation
}
\`\`\`

### 悪い例 - 任意の型の使用

\`\`\`typescript
function getUser(id: any): any {
// Loses type safety
}
\`\`\`
```

### 条件付きガイダンス

```markdown
## フレームワークの選択

- **小規模プロジェクトの場合**: 最小限のAPIアプローチを使用する
- **大規模プロジェクトの場合**: 明確に分離されたコントローラベースのアーキテクチャを使用する
- **マイクロサービスの場合**: ドメイン駆動設計パターンを検討する
```

## 避けるべきパターン

- **過度に冗長な説明**: 簡潔で読みやすいものにする
- **古い情報**: 常に最新のバージョンと実践を参照する
- **曖昧なガイドライン**: 何をすべきか、何を避けるべきかを具体的に伝える
- **不足している例**: 具体的なコード例のない抽象的なルール
- **矛盾したアドバイス**: ファイル全体の一貫性を確保する
- **ドキュメントからコピー＆ペースト**: 抽出して文脈化することで価値を付加する

## 指示のテスト

指示ファイルを確定する前に:

1. **Copilotでテストする**: VS Codeで実際のプロンプトを使って手順を試してみましょう
2. **例を確認する**: コード例が正しく、エラーなく実行されることを確認する
3. **Globパターンを確認する**: `applyTo` パターンが意図したファイルに一致することを確認する

## 構造例

新しい指示ファイルの最小限の例の構造は次のとおりです:

```markdown
---
description: "目的の簡単な説明"
applyTo: "**/*.ext"
---

# 技術名開発

簡単な紹介と背景。

## 一般的な指示

- 高レベルガイドライン1
- 高レベルガイドライン2

## ベストプラクティス

- 具体的な実践1
- 具体的な実践2

## コード標準

### 命名規則

- ルール1
- ルール2

### ファイル構成

- 構造1
- 構造2

## 一般的なパターン

### パターン1

説明と例

\`\`\`language
code example
\`\`\`

### パターン2

説明と例

## 検証

- Build command: `command to verify`
- Linting: `command to lint`
- Testing: `command to test`
```

## メンテナンス

- 依存関係やフレームワークが更新された場合は指示を確認する
- 現在のベストプラクティスを反映するように例を更新します
- 古くなったパターンや廃止された機能を削除する
- コミュニティ内で新しいパターンが出現したら追加する
- プロジェクト構造の変化に応じて glob パターンを正確に保つ

## 追加リソース

- [Custom Instructions Documentation](https://code.visualstudio.com/docs/copilot/customization/custom-instructions)
- [Awesome Copilot Instructions](https://github.com/github/awesome-copilot/tree/main/instructions)
